# Day 11: VPC Networking Fundamentals

**Date:** October 23, 2025  
**Focus:** Understanding the network layer beneath EC2 and S3  
**Time Investment:** ~90 minutes

---

## What I Learned

Explored the VPC (Virtual Private Cloud) that my EC2 instance lives in. Traced the full network path from my laptop to EC2 to S3, understanding each component's role.

**Key networking concepts:**
- VPC subnets and CIDR blocks
- Route tables (local vs internet routes)
- Internet Gateway (IGW) as the "doorway" to the internet
- Security Groups as instance-level firewalls
- Private vs public communication patterns

---

## Hands-On Work

### Network Path Tracing
Connected to my EC2 instance and ran diagnostic commands:
```bash
# Checked instance private IP
ip addr show
# Result: 172.31.17.138/20

# Checked routing table
ip route
# Result: Default gateway at 172.31.16.1

# Tested S3 connectivity
aws s3 ls
nslookup s3.amazonaws.com
# Result: S3 resolves to multiple IPs for load balancing
```

### VPC Components Explored
- **VPC ID:** vpc-048cc9b33a7b5ca7b
- **Subnet:** 172.31.16.0/20 (4,096 possible IPs)
- **Route Table:** Local route (172.31.0.0/16) + Internet route (0.0.0.0/0 â†’ IGW)
- **Internet Gateway:** igw-0b881055

1db9a6060 (attached state)
- **Security Group:** Inbound (SSH port 22, HTTP port 80 from 0.0.0.0/0), Outbound (all traffic allowed)

---

## Network Flow Diagram
```
My Laptop (SSH request)
    â†“
Internet Gateway (igw-xxx) - VPC entry point
    â†“
Route Table - Directs traffic (0.0.0.0/0 â†’ IGW, local â†’ VPC)
    â†“
Security Group - Firewall (allows SSH port 22, HTTP port 80)
    â†“
EC2 Instance (172.31.17.138)
    â†“
(When accessing S3)
    â†“
Default Gateway (172.31.16.1)
    â†“
Route Table â†’ IGW â†’ Internet â†’ S3
```

---

## Key Insights

1. **Loose Coupling Extended:** VPC networking is separate from compute. My EC2 instance relies on VPC infrastructure (IGW, route tables, security groups) but doesn't "own" them.

2. **Multiple Security Layers:** Traffic is filtered at multiple points:
   - Route table (does a path exist?)
   - Security group (is this traffic allowed?)
   
3. **Stateful Firewalls:** Security groups track connection state. When I SSH in (inbound), return traffic is automatically allowed without explicit outbound rules.

4. **DNS Load Balancing:** S3 uses multiple IP addresses to distribute traffic. Each DNS query returns different IPs.

5. **Private Alternatives:** VPC Endpoints allow EC2-to-S3 communication without traversing the internet gateway, using AWS's private backbone network.

---

## Knowledge Check Answers

**Q: What would happen if I detached the Internet Gateway?**
A: SSH would fail, website would be unreachable, EC2 couldn't reach S3 (unless using VPC endpoints). AWS blocked my attempt because my instance has a public IP mapped - this prevents accidental lockout.

**Q: Network security layers (outermost to innermost)?**
A: Internet â†’ IGW â†’ Route Table â†’ NACL â†’ Security Group â†’ EC2 Instance

**Q: Difference between IGW and Security Group?**
A: IGW is the connectivity layer (doorway to internet on/off). Security Group is the firewall layer (who/what can connect, which ports).

---

## Challenges & Corrections

**Challenge:** Mixed up inbound/outbound terminology initially. Said "outbound traffic that is incoming" - backwards!

**Correction:** 
- Inbound = traffic coming TO your instance
- Outbound = traffic leaving FROM your instance

**Challenge:** Tried to detach IGW to test theory, AWS blocked me with: "Network has mapped public addresses, unmap first."

**Insight:** AWS prevents shooting yourself in the foot. Good safety design.

---

## Analogies That Helped

- **IGW = Highway entrance/exit** - Connects your isolated VPC to the broader internet
- **Security Group = Bouncer at a club** - Checks IDs (IPs) and decides who gets in
- **Route Table = GPS** - Tells traffic which path to take based on destination

---

## Production Security Notes

Current setup uses `0.0.0.0/0` for SSH (insecure). In production:
- Restrict to specific IP ranges (office IP/32)
- Use bastion hosts or AWS Systems Manager Session Manager
- Implement VPC endpoints for S3 access (no IGW needed)

---

## Next Steps

- Day 12: NACL (Network ACL) - subnet-level firewalls (stateless vs stateful)
- Day 13: VPC endpoints hands-on (private S3 access)
- Day 14: Week 2 review + Friday sync with Andy

---

## Resources

- AWS VPC Documentation
- VPC Networking concepts from hands-on exploration
- Security group best practices

---

**Streak Status:** Day 11 of 90 (12.2% complete) ðŸ”¥
